diff --git a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/InputTileContent.kt b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/InputTileContent.kt
index 0e56582..da414b6 100644
--- a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/InputTileContent.kt
+++ b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/InputTileContent.kt
@@ -17,6 +17,7 @@ import androidx.compose.foundation.layout.offset
 import androidx.compose.foundation.layout.padding
 import androidx.compose.foundation.layout.size
 import androidx.compose.foundation.layout.width
+import androidx.compose.foundation.layout.wrapContentWidth
 import androidx.compose.foundation.lazy.LazyColumn
 import androidx.compose.foundation.lazy.items
 import androidx.compose.foundation.lazy.rememberLazyListState
@@ -90,10 +91,14 @@ import kotlin.math.absoluteValue
  * Свайп влево/вправо переключает дни.
  * Внизу — индикаторы дней с морфингом текста.
  *
- * @param entries список записей о еде за выбранный день
+ * @param entries список записей о еде за выбранный день (live для settled страницы)
  * @param availableDates список доступных дат (новые первые)
  * @param selectedDateIndex индекс выбранной даты в списке
+ * @param getCachedEntries возвращает кэшированные записи по дате или null
  * @param onDaySelected callback при смене дня (передаёт индекс)
+ * @param onPreviewDay callback во время драга пейджера с датой текущей страницы (или null)
+ * @param onDayDragProgress callback при драге пейджера: (currentPage, currentPageOffsetFraction)
+ * @param onDaySettled callback при оседании пейджера на странице (page после анимации)
  * @param isCollapsed свёрнута ли плитка (отключает клики по продуктам)
  * @param onEntryClick callback при клике на продукт
  * @param onEntryExpandRequest callback при запросе раскрытия карточки (entry + bounds в window)
@@ -103,7 +108,11 @@ fun InputTileContent(
     entries: List<DayEntry> = emptyList(),
     availableDates: List<String> = emptyList(),
     selectedDateIndex: Int = 0,
+    getCachedEntries: (String) -> List<DayEntry>? = { null },
     onDaySelected: (Int) -> Unit = {},
+    onPreviewDay: (String?) -> Unit = {},
+    onDayDragProgress: (page: Int, offset: Float) -> Unit = { _, _ -> },
+    onDaySettled: (Int) -> Unit = {},
     isCollapsed: Boolean = false,
     onEntryClick: (DayEntry) -> Unit = {},
     onEntryExpandRequest: (DayEntry, Rect) -> Unit = { _, _ -> },
@@ -143,12 +152,39 @@ fun InputTileContent(
         snapshotFlow { pagerState.settledPage }
             .distinctUntilChanged()
             .collect { page ->
-                if (!isProgrammaticScroll && page in availableDates.indices && page != selectedDateIndex) {
-                    onDaySelected(page)
+                if (!isProgrammaticScroll && page in availableDates.indices) {
+                    onDaySettled(page)
+                    if (page != selectedDateIndex) {
+                        onDaySelected(page)
+                    }
                 }
             }
     }
 
+    // Прогресс драга пейджера для синхронного движения графика ккал
+    LaunchedEffect(pagerState) {
+        snapshotFlow { pagerState.currentPage to pagerState.currentPageOffsetFraction }
+            .collect { (page, offset) ->
+                onDayDragProgress(page, offset)
+            }
+    }
+
+    // Превью даты во время драга: dashed line на графике движется вместе со свайпом; при settled — null
+    LaunchedEffect(pagerState, availableDates) {
+        snapshotFlow {
+            val frac = pagerState.currentPageOffsetFraction
+            if (frac.absoluteValue < 0.01f) {
+                null
+            } else {
+                val offset = pagerState.currentPage + frac
+                val nearest = (offset + 0.5f).toInt().coerceIn(0, (availableDates.size - 1).coerceAtLeast(0))
+                availableDates.getOrNull(nearest)
+            }
+        }.collect { date ->
+            onPreviewDay(date)
+        }
+    }
+
     Box(modifier = modifier.fillMaxSize()) {
         // Слой 1: Основной контент — источник для размытия (hazeSource)
         Box(
@@ -161,8 +197,11 @@ fun InputTileContent(
                     state = pagerState,
                     modifier = Modifier.fillMaxSize()
                 ) { page ->
+                    val date = availableDates.getOrNull(page) ?: ""
+                    val pageEntries = getCachedEntries(date)
+                        ?: if (page == selectedDateIndex) entries else emptyList()
                     DayPageContent(
-                        entries = if (page == pagerState.settledPage) entries else emptyList(),
+                        entries = pageEntries,
                         isCollapsed = isCollapsed,
                         onEntryClick = onEntryClick,
                         onEntryExpandRequest = onEntryExpandRequest,
@@ -286,8 +325,8 @@ private fun DayPageContent(
 
 /**
  * Индикаторы дней с морфинг-анимацией в glassmorphism pill-плашке.
- * Текущий день показан как текст "01.янв", остальные — как точки.
- * При свайпе текст плавно морфится в точку и наоборот.
+ * Показывает скользящее окно из 7 дней относительно текущей страницы.
+ * Текущий день показан как текст "01.янв" / "Сегодня", остальные — как точки.
  */
 @Composable
 private fun DayIndicator(
@@ -298,16 +337,20 @@ private fun DayIndicator(
     modifier: Modifier = Modifier
 ) {
     val scheme = LocalAppColorScheme.current
-    val today = remember { LocalDate.now().format(DateTimeFormatter.ISO_LOCAL_DATE) }
-    
-    // Pill-форма: высота 24dp → радиус 12dp для полукругов на краях
-    val pillShape = RoundedCornerShape(50) // 50% = pill с полукругами
+    val today = LocalDate.now().format(DateTimeFormatter.ISO_LOCAL_DATE)
+    val windowSize = 7
+    val startIndex = (currentPage - windowSize / 2).coerceIn(0, (dates.size - windowSize).coerceAtLeast(0))
+    val endIndexExclusive = (startIndex + windowSize).coerceAtMost(dates.size)
+    val window = dates.subList(startIndex, endIndexExclusive)
+
+    val pillShape = RoundedCornerShape(50)
     val supportsBlur = Build.VERSION.SDK_INT >= Build.VERSION_CODES.S
 
     Box(
         modifier = modifier
+            .wrapContentWidth()
             .clip(pillShape)
-            .background(scheme.plankBackground.copy(alpha = 0.85f), pillShape) // Видимый полупрозрачный фон
+            .background(scheme.plankBackground.copy(alpha = 0.85f), pillShape)
             .then(
                 if (supportsBlur) {
                     Modifier.hazeEffect(state = hazeState) {
@@ -316,27 +359,24 @@ private fun DayIndicator(
                         noiseFactor = DesignTokens.glassNoise
                     }
                 } else {
-                    Modifier // Fallback уже применён через background выше
+                    Modifier
                 }
             )
-            .padding(horizontal = 12.dp, vertical = 6.dp)
+            .padding(horizontal = 10.dp, vertical = 6.dp)
     ) {
         Row(
-            horizontalArrangement = Arrangement.spacedBy(8.dp),
+            horizontalArrangement = Arrangement.spacedBy(6.dp),
             verticalAlignment = Alignment.CenterVertically
         ) {
-            dates.forEachIndexed { index, date ->
-                // Вычисляем "близость" к текущей странице для морфинга
-                val distanceFromCurrent = (index - currentPage - currentPageOffset).absoluteValue
+            window.forEachIndexed { windowIndex, date ->
+                val globalIndex = startIndex + windowIndex
+                val distanceFromCurrent = (globalIndex - currentPage - currentPageOffset).absoluteValue
                 val isSelected = distanceFromCurrent < 0.5f
-                
-                // Анимация морфинга: 0 = точка, 1 = текст
                 val morphProgress by animateFloatAsState(
                     targetValue = if (isSelected) 1f else 0f,
                     animationSpec = tween(durationMillis = 200),
                     label = "morphProgress"
                 )
-
                 MorphingDateItem(
                     date = date,
                     isToday = date == today,
diff --git a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/KbjuTileContent.kt b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/KbjuTileContent.kt
index 656f221..12cc892 100644
--- a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/KbjuTileContent.kt
+++ b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/KbjuTileContent.kt
@@ -7,8 +7,11 @@ import androidx.compose.animation.core.FastOutSlowInEasing
 import androidx.compose.animation.core.tween
 import androidx.compose.animation.fadeIn
 import androidx.compose.animation.fadeOut
+import androidx.compose.foundation.Canvas
 import androidx.compose.foundation.background
 import androidx.compose.foundation.border
+import androidx.compose.foundation.gestures.detectDragGestures
+import androidx.compose.foundation.gestures.detectTapGestures
 import androidx.compose.foundation.layout.Arrangement
 import androidx.compose.foundation.layout.Box
 import androidx.compose.foundation.layout.Row
@@ -18,6 +21,7 @@ import androidx.compose.foundation.layout.fillMaxHeight
 import androidx.compose.foundation.layout.fillMaxSize
 import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.height
+import androidx.compose.foundation.layout.offset
 import androidx.compose.ui.zIndex
 import androidx.compose.foundation.layout.padding
 import androidx.compose.foundation.shape.RoundedCornerShape
@@ -31,6 +35,14 @@ import androidx.compose.runtime.remember
 import androidx.compose.runtime.setValue
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
+import androidx.compose.ui.geometry.Offset
+import androidx.compose.ui.graphics.Color
+import androidx.compose.ui.graphics.Path
+import androidx.compose.ui.graphics.PathEffect
+import androidx.compose.ui.graphics.drawscope.Stroke
+import androidx.compose.ui.input.pointer.pointerInput
+import androidx.compose.ui.input.pointer.pointerInteropFilter
+import androidx.compose.ui.platform.LocalDensity
 import androidx.compose.ui.graphics.Brush
 import androidx.compose.ui.graphics.graphicsLayer
 import androidx.compose.ui.text.font.FontStyle
@@ -39,6 +51,7 @@ import androidx.compose.ui.unit.dp
 import androidx.compose.ui.unit.sp
 import com.example.vitanlyapp.domain.model.KbjuBarStat
 import com.example.vitanlyapp.domain.model.TilePosition
+import com.example.vitanlyapp.domain.repository.DayKcalPoint
 import com.example.vitanlyapp.domain.repository.UserProfile
 import com.example.vitanlyapp.ui.component.ActivityWheelPicker
 import com.example.vitanlyapp.ui.component.KbjuBars
@@ -53,6 +66,8 @@ import dev.chrisbanes.haze.HazeTint
 import dev.chrisbanes.haze.hazeEffect
 import dev.chrisbanes.haze.hazeSource
 import kotlinx.coroutines.delay
+import java.time.LocalDate
+import java.time.format.DateTimeFormatter
 
 /**
  * Контент верхней плитки КБЖУ: волна калорий, процент, бары макронутриентов.
@@ -71,6 +86,16 @@ fun KbjuTileContent(
     macroStats: List<KbjuBarStat>,
     activeTile: TilePosition?,
     userProfile: UserProfile?,
+    kcalHistoryWindow7Days: List<DayKcalPoint>,
+    kcalWindowPrev7: List<DayKcalPoint>,
+    kcalWindowCurrent7: List<DayKcalPoint>,
+    kcalWindowNext7: List<DayKcalPoint>,
+    dragOffsetFraction: Float,
+    isPagerDragging: Boolean,
+    chartSettledDirection: Int,
+    onChartSlideComplete: () -> Unit,
+    selectedChartIndex: Int,
+    onKcalChartSelectIndex: (Int) -> Unit,
     modifier: Modifier = Modifier,
     hazeState: HazeState? = null,
     isActive: Boolean = true,
@@ -90,32 +115,31 @@ fun KbjuTileContent(
         }
     }
     
-    // Фон
-    TileBackground()
-
-    // Волна заполняет всю область — источник для размытия плашек
-    // Анимация волны приостанавливается когда плитка неактивна
-    KbjuWave(
-        percent = kcalStat.percent,
-        overflow = kcalStat.overflow,
-        animateWave = waveAnimationEnabled && isActive,
-        modifier = Modifier
-            .fillMaxSize()
-            .then(if (hazeState != null) Modifier.hazeSource(hazeState) else Modifier)
-    )
+    // Стек: фон и волна сзади (zIndex 0), контент спереди (zIndex 2)
+    Box(modifier = modifier.fillMaxSize()) {
+        Box(modifier = Modifier.fillMaxSize().zIndex(0f)) {
+            TileBackground()
+            KbjuWave(
+                percent = kcalStat.percent,
+                overflow = kcalStat.overflow,
+                animateWave = waveAnimationEnabled && isActive,
+                modifier = Modifier
+                    .fillMaxSize()
+                    .then(if (hazeState != null) Modifier.hazeSource(hazeState) else Modifier)
+            )
+        }
 
-    // Слои (снизу вверх): волна → цифры → бары
-    var showCaloriePercent by remember { mutableStateOf(false) }
-    LaunchedEffect(activeTile) {
-        if (activeTile != null) {
-            showCaloriePercent = false
-        } else {
-            delay(DesignTokens.caloriePercentAppearDelayMs.toLong())
-            showCaloriePercent = true
+        var showCaloriePercent by remember { mutableStateOf(false) }
+        LaunchedEffect(activeTile) {
+            if (activeTile != null) {
+                showCaloriePercent = false
+            } else {
+                delay(DesignTokens.caloriePercentAppearDelayMs.toLong())
+                showCaloriePercent = true
+            }
         }
-    }
 
-    Box(modifier = modifier.fillMaxSize()) {
+        Box(modifier = Modifier.fillMaxSize().zIndex(2f)) {
         // Процент калорий
         Column(
             modifier = Modifier
@@ -137,17 +161,31 @@ fun KbjuTileContent(
 
         val isExpanded = activeTile == TilePosition.TOP
         val barsHeight = DesignTokens.barHeight * 5
+        val chartBottomInset = bottomBlockHeight + DesignTokens.tilePadding * 2
+        val chartZoneTopPadding = barsTopInsetDp + barsHeight + DesignTokens.barSpacing
+
+        val chartFadeT = when {
+            topCollapseProgress <= 0.10f -> 0f
+            topCollapseProgress >= 0.35f -> 1f
+            else -> (topCollapseProgress - 0.10f) / 0.25f
+        }
+        val chartFadeSmooth = chartFadeT * chartFadeT * (3 - 2 * chartFadeT)
+        val chartAlpha = 1f - chartFadeSmooth
+        val density = LocalDensity.current
+        val chartSlideUpPx = with(density) { 24.dp.toPx() }
+        val chartTranslationY = -chartFadeSmooth * chartSlideUpPx
 
         Column(
             modifier = Modifier
                 .fillMaxSize()
+                .zIndex(1f)
                 .padding(horizontal = DesignTokens.tilePadding)
                 .padding(top = barsTopInsetDp)
         ) {
             KbjuBars(
                 stats = macroStats,
                 labels = listOf("Белок", "Жиры", "Углеводы"),
-                interactionsEnabled = isExpanded,
+                interactionsEnabled = true,
                 modifier = Modifier
                     .fillMaxWidth()
                     .then(
@@ -155,15 +193,40 @@ fun KbjuTileContent(
                         else Modifier.fillMaxSize()
                     )
             )
-            if (isExpanded && userProfile != null) {
-                UserProfileDisplay(
-                    profile = userProfile,
-                    modifier = Modifier
-                        .fillMaxWidth()
-                        .padding(top = DesignTokens.barSpacing)
+        }
+
+        if (isExpanded) {
+            Box(
+                modifier = Modifier
+                    .align(Alignment.TopStart)
+                    .fillMaxSize()
+                    .padding(
+                        top = chartZoneTopPadding,
+                        bottom = chartBottomInset,
+                        start = DesignTokens.tilePadding,
+                        end = DesignTokens.tilePadding
+                    )
+                    .graphicsLayer {
+                        clip = true
+                        alpha = chartAlpha
+                        translationY = chartTranslationY
+                    }
+                    .pointerInteropFilter { chartAlpha >= 0.01f }
+            ) {
+                KcalAreaChart(
+                    prev = kcalWindowPrev7,
+                    current = kcalWindowCurrent7,
+                    next = kcalWindowNext7,
+                    dragOffsetFraction = dragOffsetFraction,
+                    isPagerDragging = isPagerDragging,
+                    chartSettledDirection = chartSettledDirection,
+                    onChartSlideComplete = onChartSlideComplete,
+                    onSelectIndex = onKcalChartSelectIndex,
+                    modifier = Modifier.fillMaxSize()
                 )
             }
         }
+        }
     }
 }
 
@@ -309,6 +372,239 @@ private fun BottomBlock(
     }
 }
 
+private val chartLabelBottomPadding = 10.dp
+private val chartVerticalPadding = 6.dp
+private val pointRadius = 3.dp
+private val selectedPointRadius = 5.dp
+private val lineStrokeWidth = 2.dp
+private val tooltipPadding = 6.dp
+private val tooltipCornerRadius = 6.dp
+private val chartAccentColor = Color(0xFFCC7A3A)
+private val chartFillTop = chartAccentColor.copy(alpha = 0.45f)
+private val chartFillBottom = chartAccentColor.copy(alpha = 0.05f)
+private val flatLineStrokeWidth = 3.dp
+
+private const val CHART_SLIDE_DURATION_MS = 280
+
+@Composable
+private fun KcalAreaChart(
+    prev: List<DayKcalPoint>,
+    current: List<DayKcalPoint>,
+    next: List<DayKcalPoint>,
+    dragOffsetFraction: Float,
+    isPagerDragging: Boolean,
+    chartSettledDirection: Int,
+    onChartSlideComplete: () -> Unit,
+    onSelectIndex: (Int) -> Unit,
+    modifier: Modifier = Modifier
+) {
+    val scheme = LocalAppColorScheme.current
+    val density = LocalDensity.current
+    val labelColor = scheme.textColor.copy(alpha = 0.7f)
+    val combined = (prev.take(7) + current.take(7) + next.take(7))
+    val rawMaxKcal = combined.maxOfOrNull { it.kcal } ?: 0
+    val maxKcal = rawMaxKcal.coerceAtLeast(1)
+    val allEqual = combined.size >= 2 && combined.all { it.kcal == combined[0].kcal }
+    val allZeros = rawMaxKcal == 0
+    val strokeWidthPx = with(density) {
+        (if (allEqual) flatLineStrokeWidth else lineStrokeWidth).toPx()
+    }
+    val selectedGlobalIndex = 10
+    val centerKcal = current.getOrNull(3)?.kcal ?: 0
+
+    Column(modifier = modifier) {
+        Text(
+            text = "Ккал за 7 дней",
+            fontFamily = DesignTokens.fontFamilyPlank,
+            fontWeight = FontWeight.Thin,
+            fontSize = DesignTokens.fontSizeLabel,
+            color = labelColor,
+            modifier = Modifier.padding(bottom = 4.dp)
+        )
+        BoxWithConstraints(
+            modifier = Modifier
+                .fillMaxWidth()
+                .height(150.dp)
+        ) {
+            val maxWidthPx = with(density) { maxWidth.toPx() }
+            val maxHeightPx = with(density) { maxHeight.toPx() }
+            val labelBottomPx = with(density) { chartLabelBottomPadding.toPx() }
+            val verticalPaddingPx = with(density) { chartVerticalPadding.toPx() }
+            val chartLeftPx = with(density) { 4.dp.toPx() }
+            val chartRightPx = maxWidthPx - chartLeftPx
+            val chartTopPx = verticalPaddingPx
+            val chartBottomPx = maxHeightPx - labelBottomPx - verticalPaddingPx
+            val chartWidth = (chartRightPx - chartLeftPx).coerceAtLeast(1f)
+            val chartHeight = (chartBottomPx - chartTopPx).coerceAtLeast(1f)
+            val contentWidth = chartWidth * 3f
+
+            fun contentX(i: Int) = (i.toFloat() / 20f) * contentWidth
+            fun kcalToY(kcal: Int) = chartBottomPx - (kcal.toFloat() / maxKcal) * chartHeight
+
+            val points = combined.mapIndexed { i, p ->
+                Offset(contentX(i), kcalToY(p.kcal))
+            }
+
+            val lineTranslationXAnim = remember { Animatable(0f) }
+            LaunchedEffect(chartSettledDirection, isPagerDragging, chartWidth) {
+                if (!isPagerDragging && chartSettledDirection != 0) {
+                    lineTranslationXAnim.snapTo(chartSettledDirection * chartWidth)
+                    lineTranslationXAnim.animateTo(
+                        0f,
+                        animationSpec = tween(CHART_SLIDE_DURATION_MS, easing = FastOutSlowInEasing)
+                    )
+                    onChartSlideComplete()
+                }
+            }
+
+            val lineTranslationX = lineTranslationXAnim.value
+            val markerTranslationX = if (isPagerDragging) dragOffsetFraction * chartWidth else 0f
+            val baseTx = chartLeftPx - chartWidth + lineTranslationX
+
+            fun findNearestIndexInCurrent(screenPx: Float): Int {
+                val contentX = screenPx - baseTx
+                if (contentX < chartWidth || contentX > 2 * chartWidth) return 3
+                val segment = ((contentX - chartWidth) / chartWidth * 6f).toInt().coerceIn(0, 6)
+                return segment
+            }
+
+            Box(
+                modifier = Modifier
+                    .fillMaxSize()
+                    .pointerInput(combined.size, onSelectIndex) {
+                        detectTapGestures { offset ->
+                            onSelectIndex(findNearestIndexInCurrent(offset.x))
+                        }
+                        detectDragGestures { change, _ ->
+                            change.consume()
+                            onSelectIndex(findNearestIndexInCurrent(change.position.x))
+                        }
+                    }
+            ) {
+                Canvas(modifier = Modifier.fillMaxSize()) {
+                    if (points.size >= 2) {
+                        fun xLine(x: Float) = x + baseTx
+                        val linePath = Path().apply {
+                            moveTo(xLine(points[0].x), points[0].y)
+                            for (i in 1 until points.size) {
+                                lineTo(xLine(points[i].x), points[i].y)
+                            }
+                        }
+                        if (!allZeros) {
+                            val areaPath = Path().apply {
+                                addPath(linePath)
+                                lineTo(xLine(points.last().x), chartBottomPx)
+                                lineTo(xLine(points[0].x), chartBottomPx)
+                                close()
+                            }
+                            drawPath(
+                                path = areaPath,
+                                brush = Brush.verticalGradient(
+                                    colors = listOf(chartFillTop, chartFillBottom),
+                                    startY = chartTopPx,
+                                    endY = chartBottomPx
+                                )
+                            )
+                        }
+                        drawPath(
+                            path = linePath,
+                            color = chartAccentColor,
+                            style = Stroke(width = strokeWidthPx)
+                        )
+                        val pointRadiusPx = with(density) { pointRadius.toPx() }
+                        val selectedRadiusPx = with(density) { selectedPointRadius.toPx() }
+                        val selPt = points.getOrNull(selectedGlobalIndex)
+                        points.forEachIndexed { i, pt ->
+                            val isSelected = i == selectedGlobalIndex
+                            val r = if (isSelected) selectedRadiusPx else pointRadiusPx
+                            val cx = if (isSelected) pt.x + baseTx + markerTranslationX else pt.x + baseTx
+                            if (isSelected) {
+                                drawCircle(
+                                    color = chartAccentColor.copy(alpha = 0.4f),
+                                    radius = selectedRadiusPx + 3f,
+                                    center = Offset(cx, pt.y)
+                                )
+                            }
+                            drawCircle(
+                                color = chartAccentColor,
+                                radius = r,
+                                center = Offset(cx, pt.y)
+                            )
+                        }
+                        if (points.isNotEmpty() && selPt != null) {
+                            val markerX = selPt.x + baseTx + markerTranslationX
+                            val dashPx = with(density) { 6.dp.toPx() }
+                            val gapPx = with(density) { 4.dp.toPx() }
+                            drawLine(
+                                color = chartAccentColor.copy(alpha = 0.6f),
+                                start = Offset(markerX, selPt.y),
+                                end = Offset(markerX, chartBottomPx),
+                                strokeWidth = with(density) { 1.dp.toPx() },
+                                pathEffect = PathEffect.dashPathEffect(floatArrayOf(dashPx, gapPx), 0f)
+                            )
+                        }
+                    }
+                }
+                if (current.isNotEmpty()) {
+                    val selPt = points.getOrNull(selectedGlobalIndex)
+                    val selectedXScreen = (selPt?.x ?: contentWidth / 2f) + baseTx + markerTranslationX
+                    val tooltipWidthPx = with(density) { 48.dp.toPx() }
+                    val tooltipHeightPx = with(density) { 24.dp.toPx() }
+                    val maxLeftPx = chartRightPx - tooltipWidthPx
+                    val tooltipLeftPx = (selectedXScreen - tooltipWidthPx / 2f).coerceIn(chartLeftPx, maxLeftPx.coerceAtLeast(chartLeftPx))
+                    val tooltipTopPx = (selPt?.y?.minus(tooltipHeightPx) ?: chartTopPx).coerceIn(chartTopPx, (chartBottomPx - tooltipHeightPx).coerceAtLeast(chartTopPx))
+                    Box(
+                        modifier = Modifier
+                            .offset(
+                                x = with(density) { tooltipLeftPx.toDp() },
+                                y = with(density) { tooltipTopPx.toDp() }
+                            )
+                            .align(Alignment.TopStart)
+                            .clip(RoundedCornerShape(tooltipCornerRadius))
+                            .background(scheme.textColor.copy(alpha = 0.9f))
+                            .padding(horizontal = tooltipPadding, vertical = tooltipPadding / 2)
+                    ) {
+                        Text(
+                            text = "$centerKcal ккал",
+                            fontFamily = DesignTokens.fontFamilyPlank,
+                            fontWeight = FontWeight.Thin,
+                            fontSize = 11.sp,
+                            color = scheme.tileBackgroundColor
+                        )
+                    }
+                }
+            }
+        }
+        Row(
+            modifier = Modifier
+                .fillMaxWidth()
+                .padding(top = 2.dp),
+            horizontalArrangement = Arrangement.SpaceBetween
+        ) {
+            (0..6).forEach { i ->
+                val labelText = current.getOrNull(i)?.date?.let { dateStr ->
+                    runCatching {
+                        LocalDate.parse(dateStr, DateTimeFormatter.ISO_LOCAL_DATE)
+                            .format(DateTimeFormatter.ofPattern("dd.MM"))
+                    }.getOrElse { dateStr }
+                } ?: ""
+                Box(
+                    modifier = Modifier.weight(1f),
+                    contentAlignment = Alignment.Center
+                ) {
+                    Text(
+                        text = labelText,
+                        fontFamily = DesignTokens.fontFamilyPlank,
+                        fontWeight = FontWeight.Thin,
+                        fontSize = 9.sp,
+                        color = labelColor
+                    )
+                }
+            }
+        }
+    }
+}
+
 /**
  * Отображение параметров профиля (кроме веса и активности).
  * Каждый параметр — в отдельной строке.
diff --git a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/MainScreen.kt b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/MainScreen.kt
index 4cc721a..1bfcace 100644
--- a/app/src/main/java/com/example/vitanlyapp/ui/screen/main/MainScreen.kt
+++ b/app/src/main/java/com/example/vitanlyapp/ui/screen/main/MainScreen.kt
@@ -89,6 +89,7 @@ import com.example.vitanlyapp.domain.model.KbjuBarStat
 import com.example.vitanlyapp.domain.model.ThemeMode
 import com.example.vitanlyapp.domain.model.TilePosition
 import com.example.vitanlyapp.domain.repository.DayEntry
+import com.example.vitanlyapp.domain.repository.DayKcalPoint
 import com.example.vitanlyapp.domain.repository.UserProfile
 import com.example.vitanlyapp.ui.component.NoiseOverlay
 import com.example.vitanlyapp.ui.component.Tile
@@ -137,7 +138,31 @@ fun MainScreen(
     val chatLoading by viewModel.chatLoading.collectAsStateWithLifecycle()
     val themeMode by viewModel.themeMode.collectAsStateWithLifecycle()
     val userProfile by viewModel.userProfile.collectAsStateWithLifecycle()
-    
+    val kcalHistoryWindow7Days by viewModel.kcalHistoryWindow7Days.collectAsStateWithLifecycle()
+    val kcalWindowPrev7 by viewModel.kcalWindowPrev7.collectAsStateWithLifecycle()
+    val kcalWindowCurrent7 by viewModel.kcalWindowCurrent7.collectAsStateWithLifecycle()
+    val kcalWindowNext7 by viewModel.kcalWindowNext7.collectAsStateWithLifecycle()
+    val entriesCache by viewModel.entriesCacheSnapshot.collectAsStateWithLifecycle()
+
+    var dragPage by remember { mutableStateOf(0) }
+    var dragOffset by remember { mutableStateOf(0f) }
+    var isDragging by remember { mutableStateOf(false) }
+    var settledDirection by remember { mutableStateOf(0) }
+    val onDayDragProgress: (Int, Float) -> Unit = { page, offset ->
+        dragPage = page
+        dragOffset = offset
+        isDragging = true
+    }
+    val onDaySettled: (Int) -> Unit = { newPage ->
+        val wasDragging = isDragging
+        isDragging = false
+        if (wasDragging) {
+            val delta = newPage - dragPage
+            settledDirection = if (delta == 1 || delta == -1) delta else 0
+        }
+    }
+    val onChartSlideComplete: () -> Unit = { settledDirection = 0 }
+
     // Навигация по дням на средней плитке (selectedDate — источник правды)
     val selectedDate by viewModel.selectedDate.collectAsStateWithLifecycle()
     val selectedDayEntries by viewModel.selectedDayEntries.collectAsStateWithLifecycle()
@@ -312,7 +337,23 @@ fun MainScreen(
                             selectedDate = selectedDate,
                             selectedDayEntries = selectedDayEntries,
                             availableDates = availableDates,
+                            entriesCache = entriesCache,
                             userProfile = userProfile,
+                            kcalHistoryWindow7Days = kcalHistoryWindow7Days,
+                            kcalWindowPrev7 = kcalWindowPrev7,
+                            kcalWindowCurrent7 = kcalWindowCurrent7,
+                            kcalWindowNext7 = kcalWindowNext7,
+                            pagerDragPage = dragPage,
+                            pagerDragOffset = dragOffset,
+                            isPagerDragging = isDragging,
+                            chartSettledDirection = settledDirection,
+                            onDayDragProgress = onDayDragProgress,
+                            onDaySettled = onDaySettled,
+                            onChartSlideComplete = onChartSlideComplete,
+                            onKcalChartSelectIndex = { index ->
+                                kcalHistoryWindow7Days.getOrNull(index)?.date?.let { viewModel.selectDay(it) }
+                            },
+                            onPreviewDay = viewModel::setPreviewDate,
                             onEntryClick = { selectedEntry = it },
                             onEntryExpandRequest = { entry, _ ->
                                 overlayEntry = entry
@@ -340,7 +381,23 @@ fun MainScreen(
                             selectedDate = selectedDate,
                             selectedDayEntries = selectedDayEntries,
                             availableDates = availableDates,
+                            entriesCache = entriesCache,
                             userProfile = userProfile,
+                            kcalHistoryWindow7Days = kcalHistoryWindow7Days,
+                            kcalWindowPrev7 = kcalWindowPrev7,
+                            kcalWindowCurrent7 = kcalWindowCurrent7,
+                            kcalWindowNext7 = kcalWindowNext7,
+                            pagerDragPage = dragPage,
+                            pagerDragOffset = dragOffset,
+                            isPagerDragging = isDragging,
+                            chartSettledDirection = settledDirection,
+                            onDayDragProgress = onDayDragProgress,
+                            onDaySettled = onDaySettled,
+                            onChartSlideComplete = onChartSlideComplete,
+                            onKcalChartSelectIndex = { index ->
+                                kcalHistoryWindow7Days.getOrNull(index)?.date?.let { viewModel.selectDay(it) }
+                            },
+                            onPreviewDay = viewModel::setPreviewDate,
                             onEntryClick = { selectedEntry = it },
                             onEntryExpandRequest = { entry, _ ->
                                 overlayEntry = entry
@@ -755,7 +812,21 @@ private fun CompactLayout(
     selectedDate: String?,
     selectedDayEntries: List<DayEntry>,
     availableDates: List<String>,
+    entriesCache: Map<String, List<DayEntry>>,
     userProfile: UserProfile?,
+    kcalHistoryWindow7Days: List<DayKcalPoint>,
+    kcalWindowPrev7: List<DayKcalPoint>,
+    kcalWindowCurrent7: List<DayKcalPoint>,
+    kcalWindowNext7: List<DayKcalPoint>,
+    pagerDragPage: Int,
+    pagerDragOffset: Float,
+    isPagerDragging: Boolean,
+    chartSettledDirection: Int,
+    onDayDragProgress: (Int, Float) -> Unit,
+    onDaySettled: (Int) -> Unit,
+    onChartSlideComplete: () -> Unit,
+    onKcalChartSelectIndex: (Int) -> Unit,
+    onPreviewDay: (String?) -> Unit,
     onEntryClick: (DayEntry) -> Unit,
     onEntryExpandRequest: (DayEntry, Rect) -> Unit,
     onShowResetDialog: () -> Unit,
@@ -936,6 +1007,7 @@ private fun CompactLayout(
         val plankFadeAlpha = 1f - plankFadeT * (1f - DesignTokens.topTilePlanksMinAlpha)
         val plankSlideUpPx = with(density) { DesignTokens.topTilePlanksSlideUpDp.toPx() }
         val plankTranslationY = -plankSlideUpPx * plankFadeT
+        val plankHitHeightDp = (180f * (1 - plankFadeT)).dp
 
         val controlsFadeAlpha = when {
             topCollapseProgress <= DesignTokens.topTileControlsFadeStartProgress -> 1f
@@ -977,60 +1049,47 @@ private fun CompactLayout(
                 modifier = Modifier.fillMaxWidth().height(topHeightDp),
                 backgroundBrush = scheme.tileTopMiddleBackgroundBrush,
                 overflowContent = {
-                    Box(
-                        modifier = Modifier
-                            .graphicsLayer {
-                                alpha = plankFadeAlpha
-                                translationY = plankTranslationY
-                            }
-                            .pointerInteropFilter { _ ->
-                                plankFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold
-                            }
-                    ) {
-                        KbjuTileWheelOverflowContent(
-                            isExpanded = activeTile == TilePosition.TOP,
-                            currentWeight = currentWeight,
-                            onWeightChange = viewModel::updateWeight,
-                            activityCoefficient = activityCoefficient,
-                            onActivityChange = viewModel::updateActivityCoefficient,
-                            hazeState = kbjuHazeState,
-                            topCollapseProgress = topCollapseProgress
-                        )
-                    }
-                },
-                tileTransitionDurationMs = DesignTokens.topMiddlePostSnapDurationMs,
-                collapseProgress = topCollapseProgress,
-                tapToExpandOverlay = plankFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold
-            ) {
-                val scheme = LocalAppColorScheme.current
-                Box(modifier = Modifier.fillMaxSize()) {
-                    KbjuTileContent(
-                        kcalStat = kcalStat,
-                        macroStats = macroStats,
-                        activeTile = activeTile,
-                        userProfile = userProfile,
-                        hazeState = kbjuHazeState,
-                        isActive = topTilesActive,
-                        topCollapseProgress = topCollapseProgress
-                    )
-                    
-                    // Кнопки управления — фейд + сдвиг вверх синхронно с collapse (tap + splitter); неактивны в среднем/свёрнутом состоянии
-                    Box(
-                        modifier = Modifier
-                            .align(Alignment.TopEnd)
-                            .graphicsLayer {
-                                alpha = controlsFadeAlpha
-                                translationY = controlsTranslationY
-                            }
-                            .pointerInteropFilter { _ ->
-                                controlsFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold
-                            }
-                    ) {
+                    Box(modifier = Modifier.fillMaxSize()) {
+                        Box(
+                            modifier = Modifier
+                                .align(Alignment.BottomCenter)
+                                .fillMaxWidth()
+                                .height(plankHitHeightDp)
+                                .graphicsLayer {
+                                    alpha = plankFadeAlpha
+                                    translationY = plankTranslationY
+                                }
+                                .pointerInteropFilter { _ ->
+                                    plankFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold
+                                }
+                        ) {
+                            KbjuTileWheelOverflowContent(
+                                isExpanded = activeTile == TilePosition.TOP,
+                                currentWeight = currentWeight,
+                                onWeightChange = viewModel::updateWeight,
+                                activityCoefficient = activityCoefficient,
+                                onActivityChange = viewModel::updateActivityCoefficient,
+                                hazeState = kbjuHazeState,
+                                topCollapseProgress = topCollapseProgress
+                            )
+                        }
+                        Box(
+                            modifier = Modifier
+                                .align(Alignment.TopEnd)
+                                .graphicsLayer {
+                                    alpha = controlsFadeAlpha
+                                    translationY = controlsTranslationY
+                                }
+                                .then(
+                                    if (controlsFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold)
+                                        Modifier.pointerInteropFilter { true }
+                                    else Modifier
+                                )
+                        ) {
                             Row(
                                 modifier = Modifier.padding(4.dp),
                                 horizontalArrangement = Arrangement.spacedBy(4.dp)
                             ) {
-                                // Кнопка сброса данных
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1043,12 +1102,10 @@ private fun CompactLayout(
                                     Icon(
                                         imageVector = Icons.Default.DeleteForever,
                                         contentDescription = "Сбросить данные",
-                                        tint = scheme.textColor.copy(alpha = 0.5f),
+                                        tint = LocalAppColorScheme.current.textColor.copy(alpha = 0.5f),
                                         modifier = Modifier.size(22.dp)
                                     )
                                 }
-
-                                // Кнопка переключения темы
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1061,12 +1118,10 @@ private fun CompactLayout(
                                     Icon(
                                         imageVector = Icons.Default.Palette,
                                         contentDescription = "Переключить тему",
-                                        tint = scheme.textColor.copy(alpha = 0.7f),
+                                        tint = LocalAppColorScheme.current.textColor.copy(alpha = 0.7f),
                                         modifier = Modifier.size(22.dp)
                                     )
                                 }
-
-                                // Кнопка заполнения тестовых данных
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1079,13 +1134,37 @@ private fun CompactLayout(
                                     Icon(
                                         imageVector = Icons.Default.Science,
                                         contentDescription = "Тестовые данные",
-                                        tint = scheme.textColor.copy(alpha = 0.5f),
+                                        tint = LocalAppColorScheme.current.textColor.copy(alpha = 0.5f),
                                         modifier = Modifier.size(22.dp)
                                     )
                                 }
                             }
+                        }
                     }
-                }
+                },
+                tileTransitionDurationMs = DesignTokens.topMiddlePostSnapDurationMs,
+                collapseProgress = topCollapseProgress,
+                tapToExpandOverlay = plankFadeAlpha < DesignTokens.topTilePlanksInteractionAlphaThreshold
+            ) {
+                KbjuTileContent(
+                    kcalStat = kcalStat,
+                    macroStats = macroStats,
+                    activeTile = activeTile,
+                    userProfile = userProfile,
+                    kcalHistoryWindow7Days = kcalHistoryWindow7Days,
+                    kcalWindowPrev7 = kcalWindowPrev7,
+                    kcalWindowCurrent7 = kcalWindowCurrent7,
+                    kcalWindowNext7 = kcalWindowNext7,
+                    dragOffsetFraction = pagerDragOffset,
+                    isPagerDragging = isPagerDragging,
+                    chartSettledDirection = chartSettledDirection,
+                    onChartSlideComplete = onChartSlideComplete,
+                    selectedChartIndex = 3,
+                    onKcalChartSelectIndex = onKcalChartSelectIndex,
+                    hazeState = kbjuHazeState,
+                    isActive = topTilesActive,
+                    topCollapseProgress = topCollapseProgress
+                )
             }
 
             Tile(
@@ -1110,11 +1189,15 @@ private fun CompactLayout(
                     entries = selectedDayEntries,
                     availableDates = availableDates,
                     selectedDateIndex = selectedDateIndex,
+                    getCachedEntries = { date -> entriesCache[date] },
                     onDaySelected = { index ->
                         if (index < availableDates.size) {
                             viewModel.selectDay(availableDates[index])
                         }
                     },
+                    onPreviewDay = onPreviewDay,
+                    onDayDragProgress = onDayDragProgress,
+                    onDaySettled = onDaySettled,
                     isCollapsed = activeTile != null && activeTile != TilePosition.MIDDLE,
                     onEntryClick = onEntryClick,
                     onEntryExpandRequest = onEntryExpandRequest,
@@ -1234,7 +1317,21 @@ private fun ExpandedLayout(
     selectedDate: String?,
     selectedDayEntries: List<DayEntry>,
     availableDates: List<String>,
+    entriesCache: Map<String, List<DayEntry>>,
     userProfile: UserProfile?,
+    kcalHistoryWindow7Days: List<DayKcalPoint>,
+    kcalWindowPrev7: List<DayKcalPoint>,
+    kcalWindowCurrent7: List<DayKcalPoint>,
+    kcalWindowNext7: List<DayKcalPoint>,
+    pagerDragPage: Int,
+    pagerDragOffset: Float,
+    isPagerDragging: Boolean,
+    chartSettledDirection: Int,
+    onDayDragProgress: (Int, Float) -> Unit,
+    onDaySettled: (Int) -> Unit,
+    onChartSlideComplete: () -> Unit,
+    onKcalChartSelectIndex: (Int) -> Unit,
+    onPreviewDay: (String?) -> Unit,
     onEntryClick: (DayEntry) -> Unit,
     onEntryExpandRequest: (DayEntry, Rect) -> Unit,
     onShowResetDialog: () -> Unit,
@@ -1286,7 +1383,8 @@ private fun ExpandedLayout(
     val plankFadeAlphaExpanded = 1f - plankFadeTExpanded * (1f - DesignTokens.topTilePlanksMinAlpha)
     val plankSlideUpPxExpanded = with(density) { DesignTokens.topTilePlanksSlideUpDp.toPx() }
     val plankTranslationYExpanded = -plankSlideUpPxExpanded * plankFadeTExpanded
-    
+    val plankHitHeightDpExpanded = (180f * (1 - plankFadeTExpanded)).dp
+
     // Текст для автозаполнения поля ввода (из подсказки)
     var chatPrefillText by remember { mutableStateOf("") }
 
@@ -1303,56 +1401,47 @@ private fun ExpandedLayout(
                 modifier = Modifier.weight(weightTop),
                 backgroundBrush = scheme.tileTopMiddleBackgroundBrush,
                 overflowContent = {
-                    Box(
-                        modifier = Modifier
-                            .graphicsLayer {
-                                alpha = plankFadeAlphaExpanded
-                                translationY = plankTranslationYExpanded
-                            }
-                            .pointerInteropFilter { _ ->
-                                plankFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold
-                            }
-                    ) {
-                        KbjuTileWheelOverflowContent(
-                            isExpanded = activeTile == TilePosition.TOP,
-                            currentWeight = currentWeight,
-                            onWeightChange = viewModel::updateWeight,
-                            activityCoefficient = activityCoefficient,
-                            onActivityChange = viewModel::updateActivityCoefficient,
-                            hazeState = kbjuHazeState,
-                            topCollapseProgress = topCollapseProgress
-                        )
-                    }
-                },
-                tapToExpandOverlay = plankFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold
-            ) {
-                Box(modifier = Modifier.fillMaxSize()) {
-                    KbjuTileContent(
-                        kcalStat = kcalStat,
-                        macroStats = macroStats,
-                        activeTile = activeTile,
-                        userProfile = userProfile,
-                        hazeState = kbjuHazeState,
-                        topCollapseProgress = topCollapseProgress
-                    )
-                    
-                    // Кнопки управления — фейд/сдвиг по progress; неактивны в среднем/свёрнутом состоянии
-                    Box(
-                        modifier = Modifier
-                            .align(Alignment.TopEnd)
-                            .graphicsLayer {
-                                alpha = controlsFadeAlphaExpanded
-                                translationY = controlsTranslationYExpanded
-                            }
-                            .pointerInteropFilter { _ ->
-                                controlsFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold
-                            }
-                    ) {
-                        Row(
+                    Box(modifier = Modifier.fillMaxSize()) {
+                        Box(
+                            modifier = Modifier
+                                .align(Alignment.BottomCenter)
+                                .fillMaxWidth()
+                                .height(plankHitHeightDpExpanded)
+                                .graphicsLayer {
+                                    alpha = plankFadeAlphaExpanded
+                                    translationY = plankTranslationYExpanded
+                                }
+                                .pointerInteropFilter { _ ->
+                                    plankFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold
+                                }
+                        ) {
+                            KbjuTileWheelOverflowContent(
+                                isExpanded = activeTile == TilePosition.TOP,
+                                currentWeight = currentWeight,
+                                onWeightChange = viewModel::updateWeight,
+                                activityCoefficient = activityCoefficient,
+                                onActivityChange = viewModel::updateActivityCoefficient,
+                                hazeState = kbjuHazeState,
+                                topCollapseProgress = topCollapseProgress
+                            )
+                        }
+                        Box(
+                            modifier = Modifier
+                                .align(Alignment.TopEnd)
+                                .graphicsLayer {
+                                    alpha = controlsFadeAlphaExpanded
+                                    translationY = controlsTranslationYExpanded
+                                }
+                                .then(
+                                    if (controlsFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold)
+                                        Modifier.pointerInteropFilter { true }
+                                    else Modifier
+                                )
+                        ) {
+                            Row(
                                 modifier = Modifier.padding(4.dp),
                                 horizontalArrangement = Arrangement.spacedBy(4.dp)
                             ) {
-                                // Кнопка сброса данных
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1369,8 +1458,6 @@ private fun ExpandedLayout(
                                         modifier = Modifier.size(22.dp)
                                     )
                                 }
-
-                                // Кнопка переключения темы
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1387,8 +1474,6 @@ private fun ExpandedLayout(
                                         modifier = Modifier.size(22.dp)
                                     )
                                 }
-
-                                // Кнопка заполнения тестовых данных
                                 Box(
                                     modifier = Modifier
                                         .size(36.dp)
@@ -1406,8 +1491,29 @@ private fun ExpandedLayout(
                                     )
                                 }
                             }
+                        }
                     }
-                }
+                },
+                tapToExpandOverlay = plankFadeAlphaExpanded < DesignTokens.topTilePlanksInteractionAlphaThreshold
+            ) {
+                KbjuTileContent(
+                    kcalStat = kcalStat,
+                    macroStats = macroStats,
+                    activeTile = activeTile,
+                    userProfile = userProfile,
+                    kcalHistoryWindow7Days = kcalHistoryWindow7Days,
+                    kcalWindowPrev7 = kcalWindowPrev7,
+                    kcalWindowCurrent7 = kcalWindowCurrent7,
+                    kcalWindowNext7 = kcalWindowNext7,
+                    dragOffsetFraction = pagerDragOffset,
+                    isPagerDragging = isPagerDragging,
+                    chartSettledDirection = chartSettledDirection,
+                    onChartSlideComplete = onChartSlideComplete,
+                    selectedChartIndex = 3,
+                    onKcalChartSelectIndex = onKcalChartSelectIndex,
+                    hazeState = kbjuHazeState,
+                    topCollapseProgress = topCollapseProgress
+                )
             }
 
             Tile(
@@ -1430,11 +1536,15 @@ private fun ExpandedLayout(
                     entries = selectedDayEntries,
                     availableDates = availableDates,
                     selectedDateIndex = selectedDateIndex,
+                    getCachedEntries = { date -> entriesCache[date] },
                     onDaySelected = { index ->
                         if (index < availableDates.size) {
                             viewModel.selectDay(availableDates[index])
                         }
                     },
+                    onPreviewDay = onPreviewDay,
+                    onDayDragProgress = onDayDragProgress,
+                    onDaySettled = onDaySettled,
                     isCollapsed = activeTile != null && activeTile != TilePosition.MIDDLE,
                     onEntryClick = onEntryClick,
                     onEntryExpandRequest = onEntryExpandRequest
